<!DOCTYPE html>
<html>
<head>
<link rel="Stylesheet" type="text/css" href="style.css">
<title>Create Git Repo From Some Local Files</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>


<p>
So you have some files or a new Rails application, and you want to add this to a new shared remote Git repository. (I’m assuming you have access to your server and are setting up a remote repo over ssh.)
</p>

<p>
I know I can never remember how to do it, so here’s a post for me and hopefully you!
</p>

<p>
Create a local Git repository in your application for your local files.
</p>

<pre>

#On local machine
cd foo_project
git init
git add *
git commit -m "My initial commit message"

</pre>

<p>
Now, create the repository on your Git server. All of my git repositories are owned by a user git and located at /usr/local/git_root/. You can change these things accordingly to match your server setup.
</p>

<pre>

#On remote machine (Git remote repository)
sudo su - git
cd /usr/local/git_root/

</pre>


<p>
Create your new project git repo as a bare Git repository
</p>

<pre>

mkdir foo-project.git
cd foo-project.git/
git --bare init

</pre>

<p>
Make sure permissions are set properly. These are common options I use for my shared repositories
</p>

<pre>

git config core.sharedrepository 1
git config receive.denyNonFastforwards true
find objects -type d -exec chmod 02770 {} \;
#The core.sharedrepository flag tells git to keep everything group readable and writable.
#The receive.denyNonFastforwards flag makes sure that merges can't happen when you push to the repo. You have to do the merges on your local machine, and then push the result.

</pre>

<p>
Now, go back to your local repository, and add the newly created remote repository so it tracks from the remote repository (origin).
</p>

<pre>

#On local machine, in your git project
git remote add origin ssh://git@example.com:2227/usr/local/git_root/foo_project.git

</pre>

<p>
### UPDATED:
If you are on git 1.7+ you can simply do this:
</p>

<pre>

git push -u origin master

</pre>

<p>
You’re done!
</p>

<p>
———————-
If you are on an older version of git, you may need to follow these instructions to make sure your branch tracks the remote branch:
</p>

<pre>

git push origin master

</pre>
<p>
Now, to ensure that your local branch is tracking when you do a fetch, you need to use -f option to force a new local branch to be created even though it already exists.
</p>

<pre>

#Switch to origin/master so you don't get any error about "fatal: Cannot force update the current branch."
git checkout origin/master
#Create the local "master" branch that is tracking the "origin/master" branch
git branch -f master origin/master
#Switch back to your "master" branch
git checkout master

</pre>

<p>
There you have it. You should be able to push changes to origin and fetch changes to your local copy!
</p>

</body>
</html>
